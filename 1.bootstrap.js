(window.webpackJsonp=window.webpackJsonp||[]).push([[1],[,function(t,e,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]}),o=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.hasOwnProperty.call(t,n)&&r(e,t,n);return o(e,t),e},u=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=u(n(2)),c=u(n(3)),a=i(n(6)),l=new RegExp("^X|[0-9]+$");class f extends s.default.PureComponent{constructor(t,e){super(t,e),this.state={content:""}}render(){return s.default.createElement("td",null,s.default.createElement("input",{disabled:null!==this.props.guess,inputMode:"numeric",onBlur:this.onBlur.bind(this),onChange:this.onChange.bind(this),style:{color:this.getColor()},value:this.getContent()}))}getColor(){return 0==this.props.player||this.state.content.length>0?"#d63b3b":1==this.props.player?"#3bd6d0":null}getContent(){return null==this.props.guess?this.state.content:0===this.props.guess?"X":this.props.guess}onBlur(t){if(l.test(this.state.content))try{this.props.onBlur(this.props.row,this.props.col,t)}catch(t){console.log(t)}this.setState({content:""})}onChange(t){return this.setState({content:t.currentTarget.value}),this.props.onChange(this.props.row,this.props.col,t)}}class d extends s.default.PureComponent{constructor(t,e){super(t,e),this.state=this.getGameState()}componentDidMount(){this.bot=a.WasmBot.new(this.props.nrows,this.props.ncols,0),this.setState(this.getGameState()),this.shouldPonder=!0,this.ponder()}componentWillUnmount(){this.shouldPonder=!1,this.bot.free()}getGameState(){let t=[];for(let e=0;e<this.props.nrows;++e){let n=[];for(let t=0;t<this.props.ncols;++t)if(this.bot){const r=this.bot.get_cell(e,t);n.push({guess:void 0!==r.guess?r.guess:null,player:void 0!==r.player?r.player:null})}else n.push({guess:null,player:null});t.push(n)}return{activePlayer:this.bot?this.bot.get_active_player():0,winProb:this.getWinProb(),scores:this.bot?[...this.bot.get_scores()]:[0,0],grid:t}}render(){1===this.state.activePlayer&&window.setTimeout(this.takeBotAction.bind(this),0);const t=[];for(let e=0;e<this.props.nrows;e++){const n=[];for(let t=0;t<this.props.ncols;t++){const{guess:r,player:o}=this.state.grid[e][t];n.push(s.default.createElement(f,{col:t,guess:r,key:`${e},${t}`,onBlur:this.onCellInputBlur.bind(this),onChange:this.onCellInputChange.bind(this),player:o,row:e}))}t.push(s.default.createElement("tr",{key:e},n))}let e=null;var n;return null!=this.state.winProb&&(e=s.default.createElement("div",{className:"prediction"},"The CPU thinks you have a ",s.default.createElement("span",{style:{color:"#d63b3b"}},(n=this.state.winProb,new Intl.NumberFormat("en-US",{maximumSignificantDigits:4}).format(100*n)+"%"))," chance of winning.")),s.default.createElement("div",{className:"prophecies-game"},s.default.createElement("table",null,s.default.createElement("tbody",null,t)),s.default.createElement("div",{className:"scores"},s.default.createElement("div",null,"Scores:"),s.default.createElement("div",null,s.default.createElement("span",{style:{color:"#d63b3b"}},this.state.scores[0]),s.default.createElement("span",null," - "),s.default.createElement("span",{style:{color:"#3bd6d0"}},this.state.scores[1])),e))}onCellInputBlur(t,e,n){if(null!==this.state.grid[t][e].player)return;const r=n.currentTarget.value;if(!r||!r.length||!l.test(r))return;const o="X"===r?0:parseInt(r,10);this.takeAction({row:t,col:e,guess:o})}onCellInputChange(t,e,n){const r=n.target;l.test(r.value)||console.log(r.value+" failed regex")}ponder(){if(!this.shouldPonder)return;if(this.bot.is_finished())return void(this.shouldPonder=!1);const t=performance.now();let e=0;for(;performance.now()-t<128;)this.bot.playout(),++e;const n=performance.now();console.log(`${e} playouts in ${n-t} ms`),this.setState({winProb:this.getWinProb()}),window.setTimeout(this.ponder.bind(this),1024)}getWinProb(){if(!this.bot)return null;if(0!==this.bot.get_active_player())return null;const t=this.bot.get_best_action();return null==t?null:(1+t.score/Number(t.visits))/2}takeAction(t){t&&(this.bot.place(t.row,t.col,t.guess),this.setState(this.getGameState()))}takeBotAction(){const t=performance.now();for(;performance.now()-t<256;)this.bot.playout();const e=this.bot.get_best_action();null!=e?this.takeAction(e.action):this.shouldPonder=!1}}c.default.render(s.default.createElement(d,{nrows:4,ncols:4}),document.getElementById("prophecies-grid-container"))},,,function(t,e,n){"use strict";(function(t){n.d(e,"a",(function(){return v})),n.d(e,"b",(function(){return E})),n.d(e,"c",(function(){return P})),n.d(e,"d",(function(){return C})),n.d(e,"z",(function(){return j})),n.d(e,"m",(function(){return k})),n.d(e,"s",(function(){return x})),n.d(e,"g",(function(){return O})),n.d(e,"x",(function(){return A})),n.d(e,"o",(function(){return B})),n.d(e,"i",(function(){return S})),n.d(e,"q",(function(){return I})),n.d(e,"p",(function(){return z})),n.d(e,"f",(function(){return D})),n.d(e,"k",(function(){return W})),n.d(e,"v",(function(){return M})),n.d(e,"h",(function(){return U})),n.d(e,"t",(function(){return q})),n.d(e,"e",(function(){return G})),n.d(e,"l",(function(){return N})),n.d(e,"r",(function(){return R})),n.d(e,"j",(function(){return $})),n.d(e,"n",(function(){return F})),n.d(e,"u",(function(){return V})),n.d(e,"A",(function(){return X})),n.d(e,"y",(function(){return J})),n.d(e,"w",(function(){return H}));var r=n(5);let o=new("undefined"==typeof TextDecoder?(0,t.require)("util").TextDecoder:TextDecoder)("utf-8",{ignoreBOM:!0,fatal:!0});o.decode();let i=null;function u(){return null!==i&&i.buffer===r.z.buffer||(i=new Uint8Array(r.z.buffer)),i}function s(t,e){return o.decode(u().subarray(t,t+e))}const c=new Array(32).fill(void 0);c.push(void 0,null,!0,!1);let a=c.length;function l(t){a===c.length&&c.push(c.length+1);const e=a;return a=c[e],c[e]=t,e}function f(t){return c[t]}function d(t){const e=f(t);return function(t){t<36||(c[t]=a,a=t)}(t),e}let h=null;function p(){return null!==h&&h.buffer===r.z.buffer||(h=new Int32Array(r.z.buffer)),h}function _(t){return null==t}let b=null;function g(t,e){return(null!==b&&b.buffer===r.z.buffer||(b=new Uint32Array(r.z.buffer)),b).subarray(t/4,t/4+e)}let w=0;let y=new("undefined"==typeof TextEncoder?(0,t.require)("util").TextEncoder:TextEncoder)("utf-8");const m="function"==typeof y.encodeInto?function(t,e){return y.encodeInto(t,e)}:function(t,e){const n=y.encode(t);return e.set(n),{read:t.length,written:n.length}};class v{static __wrap(t){const e=Object.create(v.prototype);return e.ptr=t,e}__destroy_into_raw(){const t=this.ptr;return this.ptr=0,t}free(){const t=this.__destroy_into_raw();r.q(t)}get row(){return r.c(this.ptr)>>>0}set row(t){r.k(this.ptr,t)}get col(){return r.a(this.ptr)>>>0}set col(t){r.i(this.ptr,t)}get guess(){return r.b(this.ptr)>>>0}set guess(t){r.j(this.ptr,t)}}class E{static __wrap(t){const e=Object.create(E.prototype);return e.ptr=t,e}__destroy_into_raw(){const t=this.ptr;return this.ptr=0,t}free(){const t=this.__destroy_into_raw();r.r(t)}static new(t,e,n){var o=r.F(t,e,n);return E.__wrap(o)}is_finished(){return 0!==r.E(this.ptr)}get_scores(){try{const o=r.u(-16);r.D(o,this.ptr);var t=p()[o/4+0],e=p()[o/4+1],n=g(t,e).slice();return r.w(t,4*e),n}finally{r.u(16)}}get_cell(t,e){var n=r.C(this.ptr,t,e);return P.__wrap(n)}place(t,e,n){r.G(this.ptr,t,e,n)}playout(){r.H(this.ptr)}get_active_player(){return r.A(this.ptr)>>>0}get_best_action(){var t=r.B(this.ptr);return 0===t?void 0:C.__wrap(t)}}class P{static __wrap(t){const e=Object.create(P.prototype);return e.ptr=t,e}__destroy_into_raw(){const t=this.ptr;return this.ptr=0,t}free(){const t=this.__destroy_into_raw();r.s(t)}get player(){try{const n=r.u(-16);r.e(n,this.ptr);var t=p()[n/4+0],e=p()[n/4+1];return 0===t?void 0:e>>>0}finally{r.u(16)}}set player(t){r.m(this.ptr,!_(t),_(t)?0:t)}get guess(){try{const n=r.u(-16);r.d(n,this.ptr);var t=p()[n/4+0],e=p()[n/4+1];return 0===t?void 0:e>>>0}finally{r.u(16)}}set guess(t){r.l(this.ptr,!_(t),_(t)?0:t)}}class C{static __wrap(t){const e=Object.create(C.prototype);return e.ptr=t,e}__destroy_into_raw(){const t=this.ptr;return this.ptr=0,t}free(){const t=this.__destroy_into_raw();r.t(t)}get action(){var t=r.f(this.ptr);return v.__wrap(t)}set action(t){!function(t,e){if(!(t instanceof e))throw new Error("expected instance of "+e.name);t.ptr}(t,v);var e=t.ptr;t.ptr=0,r.n(this.ptr,e)}get visits(){return r.h(this.ptr)}set visits(t){r.p(this.ptr,t)}get score(){return r.g(this.ptr)}set score(t){r.o(this.ptr,t)}}const j=function(t,e){return l(s(t,e))},k=function(){return l(new Error)},x=function(t,e){var n=function(t,e,n){if(void 0===n){const n=y.encode(t),r=e(n.length);return u().subarray(r,r+n.length).set(n),w=n.length,r}let r=t.length,o=e(r);const i=u();let s=0;for(;s<r;s++){const e=t.charCodeAt(s);if(e>127)break;i[o+s]=e}if(s!==r){0!==s&&(t=t.slice(s)),o=n(o,r,r=s+3*t.length);const e=u().subarray(o+s,o+r);s+=m(t,e).written}return w=s,o}(f(e).stack,r.x,r.y),o=w;p()[t/4+1]=o,p()[t/4+0]=n},O=function(t,e){try{console.error(s(t,e))}finally{r.w(t,e)}},A=function(t){d(t)},B=function(t,e,n){var r,o;f(t).randomFillSync((r=e,o=n,u().subarray(r/1,r/1+o)))},S=function(t,e){f(t).getRandomValues(f(e))},I=(T=function(){return l(self.self)},function(){try{return T.apply(this,arguments)}catch(t){r.v(l(t))}});var T;const z=function(t,e,n){return l(f(t).require(s(e,n)))},D=function(t){return l(f(t).crypto)},W=function(t){return l(f(t).msCrypto)},M=function(t){return void 0===f(t)},U=function(t){return l(f(t).getRandomValues)},q=function(){return l(t)},G=function(t){return l(f(t).buffer)},N=function(t){return l(new Uint8Array(f(t)))},R=function(t,e,n){f(t).set(f(e),n>>>0)},$=function(t){return f(t).length},F=function(t){return l(new Uint8Array(t>>>0))},V=function(t,e,n){return l(f(t).subarray(e>>>0,n>>>0))},X=function(t,e){throw new Error(s(t,e))},J=function(t){throw d(t)},H=function(){return l(r.z)}}).call(this,n(7)(t))},function(t,e,n){"use strict";var r=n.w[t.i];t.exports=r;n(4);r.I()},function(t,e,n){"use strict";n.r(e);var r=n(4);n.d(e,"WasmAction",(function(){return r.a})),n.d(e,"WasmBot",(function(){return r.b})),n.d(e,"WasmCell",(function(){return r.c})),n.d(e,"WasmEdge",(function(){return r.d})),n.d(e,"__wbindgen_string_new",(function(){return r.z})),n.d(e,"__wbg_new_59cb74e423758ede",(function(){return r.m})),n.d(e,"__wbg_stack_558ba5917b466edd",(function(){return r.s})),n.d(e,"__wbg_error_4bb6c2a97407129a",(function(){return r.g})),n.d(e,"__wbindgen_object_drop_ref",(function(){return r.x})),n.d(e,"__wbg_randomFillSync_d2ba53160aec6aba",(function(){return r.o})),n.d(e,"__wbg_getRandomValues_e57c9b75ddead065",(function(){return r.i})),n.d(e,"__wbg_self_86b4b13392c7af56",(function(){return r.q})),n.d(e,"__wbg_require_f5521a5b85ad2542",(function(){return r.p})),n.d(e,"__wbg_crypto_b8c92eaac23d0d80",(function(){return r.f})),n.d(e,"__wbg_msCrypto_9ad6677321a08dd8",(function(){return r.k})),n.d(e,"__wbindgen_is_undefined",(function(){return r.v})),n.d(e,"__wbg_getRandomValues_dd27e6b0652b3236",(function(){return r.h})),n.d(e,"__wbg_static_accessor_MODULE_452b4680e8614c81",(function(){return r.t})),n.d(e,"__wbg_buffer_e35e010c3ba9f945",(function(){return r.e})),n.d(e,"__wbg_new_139e70222494b1ff",(function(){return r.l})),n.d(e,"__wbg_set_d771848e3c7935bb",(function(){return r.r})),n.d(e,"__wbg_length_2cfa674c2a529bc1",(function(){return r.j})),n.d(e,"__wbg_newwithlength_e0c461e90217842c",(function(){return r.n})),n.d(e,"__wbg_subarray_8a52f1c1a11c02a8",(function(){return r.u})),n.d(e,"__wbindgen_throw",(function(){return r.A})),n.d(e,"__wbindgen_rethrow",(function(){return r.y})),n.d(e,"__wbindgen_memory",(function(){return r.w}))},function(t,e){t.exports=function(t){if(!t.webpackPolyfill){var e=Object.create(t);e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),Object.defineProperty(e,"exports",{enumerable:!0}),e.webpackPolyfill=1}return e}}]]);